package com.wushengde.jsp;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.wushengde.domain.Book;

public class BookInfoServlet extends HttpServlet {

	public void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		response.setContentType("text/html;charset=utf-8");
		//1.获取要看的书的id，查询数据库找出书的详细信息：
		String id = request.getParameter("id");
		Book book = BookDao.getBook(id);
		if(book==null){
			response.getWriter().write("找不到这本书");
			return;
		}else{
			response.getWriter().write("<h1>书名："+book.getName()+"</h1>");
			response.getWriter().write("<h3>价格："+book.getPrice()+"元"+"</h3>");
			response.getWriter().write("<h3>作者："+book.getAuthor()+"</h3>");
			response.getWriter().write("<h3>出版社："+book.getPublish()+"</h3>");
			response.getWriter().write("<h3>描述："+book.getDescrption()+"</h3>");
		}
		
		//2.发送cookie保存最后看过的书:
		//此句是创建一个Cookie的对象：并且此对象没有无参构造函数需要直接设置其name以及其value
		Cookie last = new Cookie("last",book.getId());
		//此句设置Cookie对象在浏览器中保存的时间：以秒作为单位（以下表示存储一个月）
		last.setMaxAge(3600*24*30);
		//此句设置Cookie对象都传入到哪些路径下的servlet页面
		last.setPath(request.getContextPath());
		response.addCookie(last);
	}

	public void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {

	}

}
