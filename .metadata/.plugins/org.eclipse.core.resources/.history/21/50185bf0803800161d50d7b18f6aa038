package com.wushengde.batch;

import java.sql.Connection;
import java.sql.ResultSet;

import com.mysql.jdbc.PreparedStatement;
import com.wushengde.util.JDBCUtils;

/*
 此处使用：preparedStatement 实现批处理
 目标：插一万条记录到数据库中！
 */
public class PSBatch {
	public static void main(String[] args) {
		Connection conn=null;
		PreparedStatement ps = null;
		ResultSet rs =null;
		try{
			conn=JDBCUtils.getConn();
			ps=conn.prepareStatement(sql);
			ps.addBatch("create database day08batch");
			ps.addBatch("use day08batch");
			ps.addBatch("create table batchDemo("+
					"id int primary key auto_increment,"+
					"name varchar(20)"+
					")");
			ps.addBatch("insert into batchDemo values(null,'aaaa')");
			ps.addBatch("insert into batchDemo values(null,'bbb')");
			ps.addBatch("insert into batchDemo values(null,'cc')");
			ps.addBatch("insert into batchDemo values(null,'d')");
			ps.executeBatch();
		}catch(Exception e){
			e.printStackTrace();
		}finally{
			JDBCUtils.close(rs, ps, conn);
		}
	}
}
