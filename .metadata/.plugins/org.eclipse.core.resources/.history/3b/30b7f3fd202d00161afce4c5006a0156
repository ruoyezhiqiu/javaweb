package com.wushengde.session;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
/*
 * 涉及请求参数中乱码的问题：get请求中的乱码解决方法：
 * 
 */
public class BuyServlet extends HttpServlet {

	public void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		//判断是从哪个页面跳转过来的，即获取请求参数中prod的值来判断：
		String prod = request.getParameter("prod");
		//处理请求参数中的中文的乱码(此处是get提交方式：若使用request.setCharacterEncoding("utf-8")则无效，其只对post方式有效)
		//以下方式解决了get请求参数中的乱码问题：
		prod = new String(prod.getBytes("iso-8859-1"),"utf-8");
		
		//创建一个session对象。
		HttpSession session = request.getSession();
		Cookie jc = new Cookie("JSESSIONID",session.getId());
		jc.setPath(request.getContextPath());
		jc.setMaxAge(1800);
		response.addCookie(jc);
		session.setAttribute("prod", prod); 
	}

	public void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {

	}

}
